# spark_goods_flow_forecast
Построение динамического прогноза продаж и остатков на складах с помощью Spark

Скрипт по построению прогноза находиться в Jupiter Notebook по ссылке: <code>[goods_flow_forecast.ipynb](https://github.com/AlexeyAnanchenko/spark_goods_flow_forecast/blob/main/goods_flow_forecast.ipynb)</code>.

## Условие задачи:

1. На вход доступен фрейм данных: 
- id — уникальный идентификатор пользователя,
- timestamp — время действия на сайте, совершенное данным пользователем

Для каждого id рассчитайте усредненную длину сессии в рамках суток. Усредненная длина сессии рассчитывается как разница между первым и последним действием, произведенным на сайте.

2. Вам доступны фреймы данных:

Таблица с информацией о среднедневном спросе на каждый товар для каждой локации:
- product — уникальный идентификатор продукта
- location — уникальный идентификатор локации
- demand — значение среднедневного спроса на конкретный товар в конкретной локации в единицах товара

Таблица с информацией о складских запасах на уровне месяца:
- product — уникальный идентификатор продукта
- stock — уровень запасов в единицах товара на уровне месяца

В качестве примера рассмотрим июнь 2023 года. Вам необходимо сформировать витрину данных, в которой для каждой пары товар-локация на уровне каждой технической недели* будет рассчитано прогнозируемое значение количества проданных товаров (с учетом среднедневного спроса) и количество остатков товара на складе.

Техническая неделя — это календарная неделя или часть календарной недели, которая «укладывается» в один календарный месяц. Например, в августе 2023 года вам доступны следующие технические недели:

- 01.08—06.08
- 07.08—13.08
- 14.08—20.08
- 21.08—27.08
- 28.08—31.08